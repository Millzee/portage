Index: build.xml
===================================================================
RCS file: /home/eclipse/org.eclipse.swt.gtk.linux.x86_64/build.xml,v
retrieving revision 1.3
diff -u -r1.3 build.xml
--- build.xml	18 Apr 2005 20:27:37 -0000	1.3
+++ build.xml	26 Apr 2005 19:13:30 -0000
@@ -21,7 +21,6 @@
 
 	<target name="properties" if="eclipse.running">
 		<property name="build.compiler" value="org.eclipse.jdt.core.JDTCompilerAdapter"/>
-		<!--compile the jar in org.eclipse.swt.tools-->
 	</target>
 
 	<target name="build.update.jar" depends="init">
@@ -200,8 +199,11 @@
 	</target>
 
 	<target name="build.cfiles" depends="build.jars">
+		<!--compile the jar in org.eclipse.swt.tools-->
+		<ant antfile="build.xml" dir="${toolsplugindir}" inheritAll="false" target="build.jars" />
+
 		<!-- generate the C code from the (64 bit) SWT PI java classes -->
-		<!-- assumes the swt.jar has already been built  -->
+		<!-- assumes the swttools.jar has already been built  -->
 		<java classname="org.eclipse.swt.tools.internal.JNIGeneratorApp" classpath="${toolsplugindir}/bin:${toolsplugindir}/swttools.jar:${basedir}/swt.jar"><arg value="org.eclipse.swt.internal.gtk.OS"/><arg value="${basedir}/src/Eclipse SWT PI/gtk/library/"/><arg value="${build.result.folder}/swt.jar"/></java>
 		<java classname="org.eclipse.swt.tools.internal.JNIGeneratorApp" classpath="${toolsplugindir}/bin:${toolsplugindir}/swttools.jar:${basedir}/swt.jar"><arg value="org.eclipse.swt.internal.accessibility.gtk.ATK"/><arg value="${basedir}/src/Eclipse SWT PI/gtk/library/"/><arg value="${build.result.folder}/swt.jar"/></java>
 		<java classname="org.eclipse.swt.tools.internal.JNIGeneratorApp" classpath="${toolsplugindir}/bin:${toolsplugindir}/swttools.jar:${basedir}/swt.jar"><arg value="org.eclipse.swt.internal.cairo.Cairo"/><arg value="${basedir}/src/Eclipse SWT PI/cairo/library/"/><arg value="${build.result.folder}/swt.jar"/></java>
@@ -304,6 +306,8 @@
 		<delete file="${plugin.destination}/${full.name}.jar"/>
 		<delete file="${plugin.destination}/${full.name}.zip"/>
 		<delete dir="${temp.folder}"/>
+		<!-- delete swttools.jar so that it will be compiled in the build.jars target -->
+		<ant antfile="build.xml" dir="${toolsplugindir}" inheritAll="false"	target="clean"/>
 	</target>
 
 	<target name="refresh" depends="init" if="eclipse.running">


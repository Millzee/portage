--- fop.orig	2007-02-08 19:34:14.000000000 +1300
+++ fop	2007-02-08 19:38:22.000000000 +1300
@@ -148,22 +148,10 @@
 fi
 
 # add fop.jar, fop-sandbox and fop-hyph.jar, which reside in $FOP_HOME/build
-LOCALCLASSPATH=${FOP_HOME}/build/fop.jar${pathSepChar}${FOP_HOME}/build/fop-sandbox.jar${pathSepChar}${FOP_HOME}/build/fop-hyph.jar${pathSepChar}$LOCALCLASSPATH
+#The following line replaces a section of the upstream script that loaded the core fop jars as well as its dependencies in ${FOPHOME}/lib.
+LOCALCLASSPATH="`java-config -d --classpath=fop`"
+
 
-# add in the dependency .jar files, which reside in $FOP_HOME/lib
-DIRLIBS=${FOP_HOME}/lib/*.jar
-for i in ${DIRLIBS}
-do
-    # if the directory is empty, then it will return the input string
-    # this is stupid, so case for it
-    if [ "$i" != "${DIRLIBS}" ] ; then
-      if [ -z "$LOCALCLASSPATH" ] ; then
-        LOCALCLASSPATH=$i
-      else
-        LOCALCLASSPATH="$i"${pathSepChar}$LOCALCLASSPATH
-      fi
-    fi
-done
 
 # add in user-defined hyphenation JARs
 if [ -n "$FOP_HYPHENATION_PATH" ] ; then
